function on(n,e){return n.parent===e.parent?1:2}function dn(n){return n.reduce(gn,0)/n.length}function gn(n,e){return n+e.x}function pn(n){return 1+n.reduce(yn,0)}function yn(n,e){return Math.max(n,e.y)}function xn(n){for(var e;e=n.children;)n=e[0];return n}function mn(n){for(var e;e=n.children;)n=e[e.length-1];return n}function te(){var n=on,e=1,t=1,r=!1;function i(u){var c,s=0;u.eachAfter(function(a){var d=a.children;d?(a.x=dn(d),a.y=pn(d)):(a.x=c?s+=n(a,c):0,a.y=0,c=a)});var l=xn(u),f=mn(u),h=l.x-n(l,f)/2,o=f.x+n(f,l)/2;return u.eachAfter(r?function(a){a.x=(a.x-u.x)*e,a.y=(u.y-a.y)*t}:function(a){a.x=(a.x-h)/(o-h)*e,a.y=(1-(u.y?a.y/u.y:1))*t})}return i.separation=function(u){return arguments.length?(n=u,i):n},i.size=function(u){return arguments.length?(r=!1,e=+u[0],t=+u[1],i):r?null:[e,t]},i.nodeSize=function(u){return arguments.length?(r=!0,e=+u[0],t=+u[1],i):r?[e,t]:null},i}function vn(n){var e=0,t=n.children,r=t&&t.length;if(!r)e=1;else for(;--r>=0;)e+=t[r].value;n.value=e}function wn(){return this.eachAfter(vn)}function _n(n,e){let t=-1;for(const r of this)n.call(e,r,++t,this);return this}function zn(n,e){for(var t=this,r=[t],i,u,c=-1;t=r.pop();)if(n.call(e,t,++c,this),i=t.children)for(u=i.length-1;u>=0;--u)r.push(i[u]);return this}function An(n,e){for(var t=this,r=[t],i=[],u,c,s,l=-1;t=r.pop();)if(i.push(t),u=t.children)for(c=0,s=u.length;c<s;++c)r.push(u[c]);for(;t=i.pop();)n.call(e,t,++l,this);return this}function Mn(n,e){let t=-1;for(const r of this)if(n.call(e,r,++t,this))return r}function kn(n){return this.eachAfter(function(e){for(var t=+n(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)t+=r[i].value;e.value=t})}function Rn(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function qn(n){for(var e=this,t=Sn(e,n),r=[e];e!==t;)e=e.parent,r.push(e);for(var i=r.length;n!==t;)r.splice(i,0,n),n=n.parent;return r}function Sn(n,e){if(n===e)return n;var t=n.ancestors(),r=e.ancestors(),i=null;for(n=t.pop(),e=r.pop();n===e;)i=n,n=t.pop(),e=r.pop();return i}function In(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function Nn(){return Array.from(this)}function En(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function Ln(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e}function*bn(){var n=this,e,t=[n],r,i,u;do for(e=t.reverse(),t=[];n=e.pop();)if(yield n,r=n.children)for(i=0,u=r.length;i<u;++i)t.push(r[i]);while(t.length)}function en(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=Tn)):e===void 0&&(e=Cn);for(var t=new N(n),r,i=[t],u,c,s,l;r=i.pop();)if((c=e(r.data))&&(l=(c=Array.from(c)).length))for(r.children=c,s=l-1;s>=0;--s)i.push(u=c[s]=new N(c[s])),u.parent=r,u.depth=r.depth+1;return t.eachBefore(tn)}function Bn(){return en(this).eachBefore($n)}function Cn(n){return n.children}function Tn(n){return Array.isArray(n)?n[1]:null}function $n(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function tn(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function N(n){this.data=n,this.depth=this.height=0,this.parent=null}N.prototype=en.prototype={constructor:N,count:wn,each:_n,eachAfter:An,eachBefore:zn,find:Mn,sum:kn,sort:Rn,path:qn,ancestors:In,descendants:Nn,leaves:En,links:Ln,copy:Bn,[Symbol.iterator]:bn};function B(n){return n==null?null:rn(n)}function rn(n){if(typeof n!="function")throw new Error;return n}function q(){return 0}function I(n){return function(){return n}}const On=1664525,Vn=1013904223,H=4294967296;function K(){let n=1;return()=>(n=(On*n+Vn)%H)/H}function Wn(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function jn(n,e){let t=n.length,r,i;for(;t;)i=e()*t--|0,r=n[t],n[t]=n[i],n[i]=r;return n}function re(n){return un(n,K())}function un(n,e){for(var t=0,r=(n=jn(Array.from(n),e)).length,i=[],u,c;t<r;)u=n[t],c&&an(c,u)?++t:(c=Pn(i=Dn(i,u)),t=0);return c}function Dn(n,e){var t,r;if(O(e,n))return[e];for(t=0;t<n.length;++t)if(L(e,n[t])&&O(E(n[t],e),n))return[n[t],e];for(t=0;t<n.length-1;++t)for(r=t+1;r<n.length;++r)if(L(E(n[t],n[r]),e)&&L(E(n[t],e),n[r])&&L(E(n[r],e),n[t])&&O(fn(n[t],n[r],e),n))return[n[t],n[r],e];throw new Error}function L(n,e){var t=n.r-e.r,r=e.x-n.x,i=e.y-n.y;return t<0||t*t<r*r+i*i}function an(n,e){var t=n.r-e.r+Math.max(n.r,e.r,1)*1e-9,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function O(n,e){for(var t=0;t<e.length;++t)if(!an(n,e[t]))return!1;return!0}function Pn(n){switch(n.length){case 1:return Kn(n[0]);case 2:return E(n[0],n[1]);case 3:return fn(n[0],n[1],n[2])}}function Kn(n){return{x:n.x,y:n.y,r:n.r}}function E(n,e){var t=n.x,r=n.y,i=n.r,u=e.x,c=e.y,s=e.r,l=u-t,f=c-r,h=s-i,o=Math.sqrt(l*l+f*f);return{x:(t+u+l/o*h)/2,y:(r+c+f/o*h)/2,r:(o+i+s)/2}}function fn(n,e,t){var r=n.x,i=n.y,u=n.r,c=e.x,s=e.y,l=e.r,f=t.x,h=t.y,o=t.r,a=r-c,d=r-f,g=i-s,p=i-h,y=l-u,x=o-u,m=r*r+i*i-u*u,_=m-c*c-s*s+l*l,w=m-f*f-h*h+o*o,v=d*g-a*p,z=(g*w-p*_)/(v*2)-r,k=(p*y-g*x)/v,A=(d*_-a*w)/(v*2)-i,M=(a*x-d*y)/v,S=k*k+M*M-1,R=2*(u+z*k+A*M),Y=z*z+A*A-u*u,$=-(Math.abs(S)>1e-6?(R+Math.sqrt(R*R-4*S*Y))/(2*S):Y/R);return{x:r+z+k*$,y:i+A+M*$,r:$}}function Z(n,e,t){var r=n.x-e.x,i,u,c=n.y-e.y,s,l,f=r*r+c*c;f?(u=e.r+t.r,u*=u,l=n.r+t.r,l*=l,u>l?(i=(f+l-u)/(2*f),s=Math.sqrt(Math.max(0,l/f-i*i)),t.x=n.x-i*r-s*c,t.y=n.y-i*c+s*r):(i=(f+u-l)/(2*f),s=Math.sqrt(Math.max(0,u/f-i*i)),t.x=e.x+i*r-s*c,t.y=e.y+i*c+s*r)):(t.x=e.x+t.r,t.y=e.y)}function F(n,e){var t=n.r+e.r-1e-6,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function G(n){var e=n._,t=n.next._,r=e.r+t.r,i=(e.x*t.r+t.x*e.r)/r,u=(e.y*t.r+t.y*e.r)/r;return i*i+u*u}function b(n){this._=n,this.next=null,this.previous=null}function cn(n,e){if(!(u=(n=Wn(n)).length))return 0;var t,r,i,u,c,s,l,f,h,o,a;if(t=n[0],t.x=0,t.y=0,!(u>1))return t.r;if(r=n[1],t.x=-r.r,r.x=t.r,r.y=0,!(u>2))return t.r+r.r;Z(r,t,i=n[2]),t=new b(t),r=new b(r),i=new b(i),t.next=i.previous=r,r.next=t.previous=i,i.next=r.previous=t;n:for(l=3;l<u;++l){Z(t._,r._,i=n[l]),i=new b(i),f=r.next,h=t.previous,o=r._.r,a=t._.r;do if(o<=a){if(F(f._,i._)){r=f,t.next=r,r.previous=t,--l;continue n}o+=f._.r,f=f.next}else{if(F(h._,i._)){t=h,t.next=r,r.previous=t,--l;continue n}a+=h._.r,h=h.previous}while(f!==h.next);for(i.previous=t,i.next=r,t.next=r.previous=r=i,c=G(t);(i=i.next)!==r;)(s=G(i))<c&&(t=i,c=s);r=t.next}for(t=[r._],i=r;(i=i.next)!==r;)t.push(i._);for(i=un(t,e),l=0;l<u;++l)t=n[l],t.x-=i.x,t.y-=i.y;return i.r}function ie(n){return cn(n,K()),n}function Xn(n){return Math.sqrt(n.value)}function ue(){var n=null,e=1,t=1,r=q;function i(u){const c=K();return u.x=e/2,u.y=t/2,n?u.eachBefore(J(n)).eachAfter(V(r,.5,c)).eachBefore(Q(1)):u.eachBefore(J(Xn)).eachAfter(V(q,1,c)).eachAfter(V(r,u.r/Math.min(e,t),c)).eachBefore(Q(Math.min(e,t)/(2*u.r))),u}return i.radius=function(u){return arguments.length?(n=B(u),i):n},i.size=function(u){return arguments.length?(e=+u[0],t=+u[1],i):[e,t]},i.padding=function(u){return arguments.length?(r=typeof u=="function"?u:I(+u),i):r},i}function J(n){return function(e){e.children||(e.r=Math.max(0,+n(e)||0))}}function V(n,e,t){return function(r){if(i=r.children){var i,u,c=i.length,s=n(r)*e||0,l;if(s)for(u=0;u<c;++u)i[u].r+=s;if(l=cn(i,t),s)for(u=0;u<c;++u)i[u].r-=s;r.r=l+s}}}function Q(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function ln(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1)}function T(n,e,t,r,i){for(var u=n.children,c,s=-1,l=u.length,f=n.value&&(r-e)/n.value;++s<l;)c=u[s],c.y0=t,c.y1=i,c.x0=e,c.x1=e+=c.value*f}function ae(){var n=1,e=1,t=0,r=!1;function i(c){var s=c.height+1;return c.x0=c.y0=t,c.x1=n,c.y1=e/s,c.eachBefore(u(e,s)),r&&c.eachBefore(ln),c}function u(c,s){return function(l){l.children&&T(l,l.x0,c*(l.depth+1)/s,l.x1,c*(l.depth+2)/s);var f=l.x0,h=l.y0,o=l.x1-t,a=l.y1-t;o<f&&(f=o=(f+o)/2),a<h&&(h=a=(h+a)/2),l.x0=f,l.y0=h,l.x1=o,l.y1=a}}return i.round=function(c){return arguments.length?(r=!!c,i):r},i.size=function(c){return arguments.length?(n=+c[0],e=+c[1],i):[n,e]},i.padding=function(c){return arguments.length?(t=+c,i):t},i}var Yn={depth:-1},U={},W={};function Hn(n){return n.id}function Zn(n){return n.parentId}function fe(){var n=Hn,e=Zn,t;function r(i){var u=Array.from(i),c=n,s=e,l,f,h,o,a,d,g,p,y=new Map;if(t!=null){const x=u.map((w,v)=>Fn(t(w,v,i))),m=x.map(nn),_=new Set(x).add("");for(const w of m)_.has(w)||(_.add(w),x.push(w),m.push(nn(w)),u.push(W));c=(w,v)=>x[v],s=(w,v)=>m[v]}for(h=0,l=u.length;h<l;++h)f=u[h],d=u[h]=new N(f),(g=c(f,h,i))!=null&&(g+="")&&(p=d.id=g,y.set(p,y.has(p)?U:d)),(g=s(f,h,i))!=null&&(g+="")&&(d.parent=g);for(h=0;h<l;++h)if(d=u[h],g=d.parent){if(a=y.get(g),!a)throw new Error("missing: "+g);if(a===U)throw new Error("ambiguous: "+g);a.children?a.children.push(d):a.children=[d],d.parent=a}else{if(o)throw new Error("multiple roots");o=d}if(!o)throw new Error("no root");if(t!=null){for(;o.data===W&&o.children.length===1;)o=o.children[0],--l;for(let x=u.length-1;x>=0&&(d=u[x],d.data===W);--x)d.data=null}if(o.parent=Yn,o.eachBefore(function(x){x.depth=x.parent.depth+1,--l}).eachBefore(tn),o.parent=null,l>0)throw new Error("cycle");return o}return r.id=function(i){return arguments.length?(n=B(i),r):n},r.parentId=function(i){return arguments.length?(e=B(i),r):e},r.path=function(i){return arguments.length?(t=B(i),r):t},r}function Fn(n){n=`${n}`;let e=n.length;return P(n,e-1)&&!P(n,e-2)&&(n=n.slice(0,-1)),n[0]==="/"?n:`/${n}`}function nn(n){let e=n.length;if(e<2)return"";for(;--e>1&&!P(n,e););return n.slice(0,e)}function P(n,e){if(n[e]==="/"){let t=0;for(;e>0&&n[--e]==="\\";)++t;if((t&1)===0)return!0}return!1}function Gn(n,e){return n.parent===e.parent?1:2}function j(n){var e=n.children;return e?e[0]:n.t}function D(n){var e=n.children;return e?e[e.length-1]:n.t}function Jn(n,e,t){var r=t/(e.i-n.i);e.c-=r,e.s+=t,n.c+=r,e.z+=t,e.m+=t}function Qn(n){for(var e=0,t=0,r=n.children,i=r.length,u;--i>=0;)u=r[i],u.z+=e,u.m+=e,e+=u.s+(t+=u.c)}function Un(n,e,t){return n.a.parent===e.parent?n.a:t}function C(n,e){this._=n,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}C.prototype=Object.create(N.prototype);function ne(n){for(var e=new C(n,0),t,r=[e],i,u,c,s;t=r.pop();)if(u=t._.children)for(t.children=new Array(s=u.length),c=s-1;c>=0;--c)r.push(i=t.children[c]=new C(u[c],c)),i.parent=t;return(e.parent=new C(null,0)).children=[e],e}function ce(){var n=Gn,e=1,t=1,r=null;function i(f){var h=ne(f);if(h.eachAfter(u),h.parent.m=-h.z,h.eachBefore(c),r)f.eachBefore(l);else{var o=f,a=f,d=f;f.eachBefore(function(m){m.x<o.x&&(o=m),m.x>a.x&&(a=m),m.depth>d.depth&&(d=m)});var g=o===a?1:n(o,a)/2,p=g-o.x,y=e/(a.x+g+p),x=t/(d.depth||1);f.eachBefore(function(m){m.x=(m.x+p)*y,m.y=m.depth*x})}return f}function u(f){var h=f.children,o=f.parent.children,a=f.i?o[f.i-1]:null;if(h){Qn(f);var d=(h[0].z+h[h.length-1].z)/2;a?(f.z=a.z+n(f._,a._),f.m=f.z-d):f.z=d}else a&&(f.z=a.z+n(f._,a._));f.parent.A=s(f,a,f.parent.A||o[0])}function c(f){f._.x=f.z+f.parent.m,f.m+=f.parent.m}function s(f,h,o){if(h){for(var a=f,d=f,g=h,p=a.parent.children[0],y=a.m,x=d.m,m=g.m,_=p.m,w;g=D(g),a=j(a),g&&a;)p=j(p),d=D(d),d.a=f,w=g.z+m-a.z-y+n(g._,a._),w>0&&(Jn(Un(g,f,o),f,w),y+=w,x+=w),m+=g.m,y+=a.m,_+=p.m,x+=d.m;g&&!D(d)&&(d.t=g,d.m+=m-x),a&&!j(p)&&(p.t=a,p.m+=y-_,o=f)}return o}function l(f){f.x*=e,f.y=f.depth*t}return i.separation=function(f){return arguments.length?(n=f,i):n},i.size=function(f){return arguments.length?(r=!1,e=+f[0],t=+f[1],i):r?null:[e,t]},i.nodeSize=function(f){return arguments.length?(r=!0,e=+f[0],t=+f[1],i):r?[e,t]:null},i}function X(n,e,t,r,i){for(var u=n.children,c,s=-1,l=u.length,f=n.value&&(i-t)/n.value;++s<l;)c=u[s],c.x0=e,c.x1=r,c.y0=t,c.y1=t+=c.value*f}var hn=(1+Math.sqrt(5))/2;function sn(n,e,t,r,i,u){for(var c=[],s=e.children,l,f,h=0,o=0,a=s.length,d,g,p=e.value,y,x,m,_,w,v,z;h<a;){d=i-t,g=u-r;do y=s[o++].value;while(!y&&o<a);for(x=m=y,v=Math.max(g/d,d/g)/(p*n),z=y*y*v,w=Math.max(m/z,z/x);o<a;++o){if(y+=f=s[o].value,f<x&&(x=f),f>m&&(m=f),z=y*y*v,_=Math.max(m/z,z/x),_>w){y-=f;break}w=_}c.push(l={value:y,dice:d<g,children:s.slice(h,o)}),l.dice?T(l,t,r,i,p?r+=g*y/p:u):X(l,t,r,p?t+=d*y/p:i,u),p-=y,h=o}return c}const ee=function n(e){function t(r,i,u,c,s){sn(e,r,i,u,c,s)}return t.ratio=function(r){return n((r=+r)>1?r:1)},t}(hn);function le(){var n=ee,e=!1,t=1,r=1,i=[0],u=q,c=q,s=q,l=q,f=q;function h(a){return a.x0=a.y0=0,a.x1=t,a.y1=r,a.eachBefore(o),i=[0],e&&a.eachBefore(ln),a}function o(a){var d=i[a.depth],g=a.x0+d,p=a.y0+d,y=a.x1-d,x=a.y1-d;y<g&&(g=y=(g+y)/2),x<p&&(p=x=(p+x)/2),a.x0=g,a.y0=p,a.x1=y,a.y1=x,a.children&&(d=i[a.depth+1]=u(a)/2,g+=f(a)-d,p+=c(a)-d,y-=s(a)-d,x-=l(a)-d,y<g&&(g=y=(g+y)/2),x<p&&(p=x=(p+x)/2),n(a,g,p,y,x))}return h.round=function(a){return arguments.length?(e=!!a,h):e},h.size=function(a){return arguments.length?(t=+a[0],r=+a[1],h):[t,r]},h.tile=function(a){return arguments.length?(n=rn(a),h):n},h.padding=function(a){return arguments.length?h.paddingInner(a).paddingOuter(a):h.paddingInner()},h.paddingInner=function(a){return arguments.length?(u=typeof a=="function"?a:I(+a),h):u},h.paddingOuter=function(a){return arguments.length?h.paddingTop(a).paddingRight(a).paddingBottom(a).paddingLeft(a):h.paddingTop()},h.paddingTop=function(a){return arguments.length?(c=typeof a=="function"?a:I(+a),h):c},h.paddingRight=function(a){return arguments.length?(s=typeof a=="function"?a:I(+a),h):s},h.paddingBottom=function(a){return arguments.length?(l=typeof a=="function"?a:I(+a),h):l},h.paddingLeft=function(a){return arguments.length?(f=typeof a=="function"?a:I(+a),h):f},h}function he(n,e,t,r,i){var u=n.children,c,s=u.length,l,f=new Array(s+1);for(f[0]=l=c=0;c<s;++c)f[c+1]=l+=u[c].value;h(0,s,n.value,e,t,r,i);function h(o,a,d,g,p,y,x){if(o>=a-1){var m=u[o];m.x0=g,m.y0=p,m.x1=y,m.y1=x;return}for(var _=f[o],w=d/2+_,v=o+1,z=a-1;v<z;){var k=v+z>>>1;f[k]<w?v=k+1:z=k}w-f[v-1]<f[v]-w&&o+1<v&&--v;var A=f[v]-_,M=d-A;if(y-g>x-p){var S=d?(g*M+y*A)/d:y;h(o,v,A,g,p,S,x),h(v,a,M,S,p,y,x)}else{var R=d?(p*M+x*A)/d:x;h(o,v,A,g,p,y,R),h(v,a,M,g,R,y,x)}}}function se(n,e,t,r,i){(n.depth&1?X:T)(n,e,t,r,i)}const oe=function n(e){function t(r,i,u,c,s){if((l=r._squarify)&&l.ratio===e)for(var l,f,h,o,a=-1,d,g=l.length,p=r.value;++a<g;){for(f=l[a],h=f.children,o=f.value=0,d=h.length;o<d;++o)f.value+=h[o].value;f.dice?T(f,i,u,c,p?u+=(s-u)*f.value/p:s):X(f,i,u,p?i+=(c-i)*f.value/p:c,s),p-=f.value}else r._squarify=l=sn(e,r,i,u,c,s),l.ratio=e}return t.ratio=function(r){return n((r=+r)>1?r:1)},t}(hn);export{N,fe as a,le as b,te as c,he as d,re as e,T as f,X as g,en as h,ue as i,se as j,ee as k,ae as p,oe as r,ie as s,ce as t};
