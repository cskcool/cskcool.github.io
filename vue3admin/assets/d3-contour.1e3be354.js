import{E as W,o as X,a3 as U,O as Y,h as $,F as O}from"./d3-array.4f7e00f9.js";var D=Array.prototype,V=D.slice;function G(n,o){return n-o}function H(n){for(var o=0,s=n.length,d=n[s-1][1]*n[0][0]-n[s-1][0]*n[0][1];++o<s;)d+=n[o-1][1]*n[o][0]-n[o-1][0]*n[o][1];return d}const P=n=>()=>n;function J(n,o){for(var s=-1,d=o.length,c;++s<d;)if(c=K(n,o[s]))return c;return 0}function K(n,o){for(var s=o[0],d=o[1],c=-1,p=0,y=n.length,v=y-1;p<y;v=p++){var E=n[p],r=E[0],e=E[1],u=n[v],i=u[0],h=u[1];if(Q(E,u,o))return 0;e>d!=h>d&&s<(i-r)*(d-e)/(h-e)+r&&(c=-c)}return c}function Q(n,o,s){var d;return T(n,o,s)&&Z(n[d=+(n[0]===o[0])],s[d],o[d])}function T(n,o,s){return(o[0]-n[0])*(s[1]-n[1])===(s[0]-n[0])*(o[1]-n[1])}function Z(n,o,s){return n<=o&&o<=s||s<=o&&o<=n}function q(){}var I=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function x(){var n=1,o=1,s=W,d=E;function c(r){var e=s(r);if(Array.isArray(e))e=e.slice().sort(G);else{const u=X(r,j);for(e=U(...Y(u[0],u[1],e),e);e[e.length-1]>=u[1];)e.pop();for(;e[1]<u[0];)e.shift()}return e.map(u=>p(r,u))}function p(r,e){const u=e==null?NaN:+e;if(isNaN(u))throw new Error(`invalid value: ${e}`);var i=[],h=[];return y(r,u,function(f){d(f,r,u),H(f)>0?i.push([f]):h.push(f)}),h.forEach(function(f){for(var w=0,k=i.length,g;w<k;++w)if(J((g=i[w])[0],f)!==-1){g.push(f);return}}),{type:"MultiPolygon",value:e,coordinates:i}}function y(r,e,u){var i=new Array,h=new Array,f,w,k,g,t,m;for(f=w=-1,g=b(r[0],e),I[g<<1].forEach(l);++f<n-1;)k=g,g=b(r[f+1],e),I[k|g<<1].forEach(l);for(I[g<<0].forEach(l);++w<o-1;){for(f=-1,g=b(r[w*n+n],e),t=b(r[w*n],e),I[g<<1|t<<2].forEach(l);++f<n-1;)k=g,g=b(r[w*n+n+f+1],e),m=t,t=b(r[w*n+f+1],e),I[k|g<<1|t<<2|m<<3].forEach(l);I[g|t<<3].forEach(l)}for(f=-1,t=r[w*n]>=e,I[t<<2].forEach(l);++f<n-1;)m=t,t=b(r[w*n+f+1],e),I[t<<2|m<<3].forEach(l);I[t<<3].forEach(l);function l(z){var N=[z[0][0]+f,z[0][1]+w],M=[z[1][0]+f,z[1][1]+w],F=v(N),C=v(M),a,A;(a=h[F])?(A=i[C])?(delete h[a.end],delete i[A.start],a===A?(a.ring.push(M),u(a.ring)):i[a.start]=h[A.end]={start:a.start,end:A.end,ring:a.ring.concat(A.ring)}):(delete h[a.end],a.ring.push(M),h[a.end=C]=a):(a=i[C])?(A=h[F])?(delete i[a.start],delete h[A.end],a===A?(a.ring.push(M),u(a.ring)):i[A.start]=h[a.end]={start:A.start,end:a.end,ring:A.ring.concat(a.ring)}):(delete i[a.start],a.ring.unshift(N),i[a.start=F]=a):i[F]=h[C]={start:F,end:C,ring:[N,M]}}}function v(r){return r[0]*2+r[1]*(n+1)*4}function E(r,e,u){r.forEach(function(i){var h=i[0],f=i[1],w=h|0,k=f|0,g=B(e[k*n+w]);h>0&&h<n&&w===h&&(i[0]=R(h,B(e[k*n+w-1]),g,u)),f>0&&f<o&&k===f&&(i[1]=R(f,B(e[(k-1)*n+w]),g,u))})}return c.contour=p,c.size=function(r){if(!arguments.length)return[n,o];var e=Math.floor(r[0]),u=Math.floor(r[1]);if(!(e>=0&&u>=0))throw new Error("invalid size");return n=e,o=u,c},c.thresholds=function(r){return arguments.length?(s=typeof r=="function"?r:Array.isArray(r)?P(V.call(r)):P(r),c):s},c.smooth=function(r){return arguments.length?(d=r?E:q,c):d===E},c}function j(n){return isFinite(n)?n:NaN}function b(n,o){return n==null?!1:+n>=o}function B(n){return n==null||isNaN(n=+n)?-1/0:n}function R(n,o,s,d){const c=d-o,p=s-o,y=isFinite(c)||isFinite(p)?c/p:Math.sign(c)/Math.sign(p);return isNaN(y)?n:n+y-.5}function _(n){return n[0]}function nn(n){return n[1]}function tn(){return 1}function en(){var n=_,o=nn,s=tn,d=960,c=500,p=20,y=2,v=p*3,E=d+v*2>>y,r=c+v*2>>y,e=P(20);function u(t){var m=new Float32Array(E*r),l=Math.pow(2,-y),z=-1;for(const S of t){var N=(n(S,++z,t)+v)*l,M=(o(S,z,t)+v)*l,F=+s(S,z,t);if(F&&N>=0&&N<E&&M>=0&&M<r){var C=Math.floor(N),a=Math.floor(M),A=N-C-.5,L=M-a-.5;m[C+a*E]+=(1-A)*(1-L)*F,m[C+1+a*E]+=A*(1-L)*F,m[C+1+(a+1)*E]+=A*L*F,m[C+(a+1)*E]+=(1-A)*L*F}}return $({data:m,width:E,height:r},p*l),m}function i(t){var m=u(t),l=e(m),z=Math.pow(2,2*y);return Array.isArray(l)||(l=U(Number.MIN_VALUE,O(m)/z,l)),x().size([E,r]).thresholds(l.map(N=>N*z))(m).map((N,M)=>(N.value=+l[M],h(N)))}i.contours=function(t){var m=u(t),l=x().size([E,r]),z=Math.pow(2,2*y),N=M=>{M=+M;var F=h(l.contour(m,M*z));return F.value=M,F};return Object.defineProperty(N,"max",{get:()=>O(m)/z}),N};function h(t){return t.coordinates.forEach(f),t}function f(t){t.forEach(w)}function w(t){t.forEach(k)}function k(t){t[0]=t[0]*Math.pow(2,y)-v,t[1]=t[1]*Math.pow(2,y)-v}function g(){return v=p*3,E=d+v*2>>y,r=c+v*2>>y,i}return i.x=function(t){return arguments.length?(n=typeof t=="function"?t:P(+t),i):n},i.y=function(t){return arguments.length?(o=typeof t=="function"?t:P(+t),i):o},i.weight=function(t){return arguments.length?(s=typeof t=="function"?t:P(+t),i):s},i.size=function(t){if(!arguments.length)return[d,c];var m=+t[0],l=+t[1];if(!(m>=0&&l>=0))throw new Error("invalid size");return d=m,c=l,g()},i.cellSize=function(t){if(!arguments.length)return 1<<y;if(!((t=+t)>=1))throw new Error("invalid cell size");return y=Math.floor(Math.log(t)/Math.LN2),g()},i.thresholds=function(t){return arguments.length?(e=typeof t=="function"?t:Array.isArray(t)?P(V.call(t)):P(t),i):e},i.bandwidth=function(t){if(!arguments.length)return Math.sqrt(p*(p+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return p=(Math.sqrt(4*t*t+1)-1)/2,g()},i}export{x as C,en as d};
